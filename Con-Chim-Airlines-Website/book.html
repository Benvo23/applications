<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book a Flight | 𝒞𝑜𝓃 𝒞𝒽𝒾𝓂 𝒜𝒾𝓇𝓁𝒾𝓃𝑒𝓈</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
        :root {
            --primary-blue: #0A2463;
            --secondary-blue: #3E5F8A;
            --accent-yellow: #FFC300;
            --light-bg: #f8f9fa;
            --white: #ffffff;
            --dark-text: #343a40;
            --gray-text: #6c757d;
            --success-green: #28a745;
            --danger-red: #dc3545;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--white); color: var(--dark-text); line-height: 1.7; }
        .container { width: 90%; max-width: 1100px; margin: 0 auto; }
        .section { padding: 80px 0; }

        /* --- NEW: Notification Bar --- */
        .notification {
            position: fixed;
            top: -100px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--success-green);
            color: var(--white);
            padding: 1rem 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 9999;
            transition: top 0.5s ease-in-out;
            font-weight: 500;
        }
        .notification.show {
            top: 20px;
        }

        /* --- Navigation Bar --- */
        .navbar { display: flex; justify-content: space-between; align-items: center; padding: 1rem 0; background-color: var(--white); border-bottom: 1px solid #eee; position: sticky; top: 0; z-index: 1000; }
        .nav-logo { font-size: 1.8rem; font-weight: 700; color: var(--primary-blue); text-decoration: none; }
        .nav-logo span { color: var(--accent-yellow); }

        /* --- Booking Form --- */
        .booking-section {
            background-image: linear-gradient(rgba(10, 36, 99, 0.7), rgba(10, 36, 99, 0.7)), url('https://www.outlooktravelmag.com/media/vietnam-1-1611926800.profileImage.2x-jpg-webp.webp');
            background-size: cover; background-position: center;
        }

        .booking-section .section-title {
            color: var(--white);
            text-align: center;
        }
        .booking-section .section-subtitle {
             color: var(--white);
             text-align: center; /* THIS IS THE FIX */
             max-width: 800px;
             margin: 0 auto 60px auto;
             font-size: 1.1rem;
        }

        .booking-form { max-width: 900px; margin: 0 auto; background: var(--white); padding: 2.5rem; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .trip-type { display: flex; gap: 1.5rem; margin-bottom: 1.5rem; }
        .trip-type label { display: flex; align-items: center; gap: 0.5rem; cursor: pointer; }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { margin-bottom: 0.5rem; font-weight: 500; color: var(--secondary-blue); }
        .form-group input, .form-group select { padding: 0.75rem; border: 1px solid #ced4da; border-radius: 5px; font-family: 'Poppins', sans-serif; font-size: 1rem; }
        .full-width { grid-column: 1 / -1; }
        .submit-btn {
            background-color: var(--accent-yellow); color: var(--primary-blue); border: none; padding: 0.8rem 1.5rem; font-size: 1.1rem; font-weight: 600; border-radius: 5px; cursor: pointer; transition: all 0.3s ease; width: 100%;
        }
        .submit-btn:hover { background-color: #ffcd33; transform: translateY(-2px); }
        #return-date-group { display: none; }

        /* --- Flight Results Section --- */
        .section-title { text-align: center; font-size: 2.8rem; margin-bottom: 1rem; color: var(--primary-blue); }
        .results-title { font-size: 1.8rem; color: var(--primary-blue); margin-bottom: 1.5rem; border-bottom: 2px solid var(--accent-yellow); padding-bottom: 0.5rem;}
        .results-group { margin-bottom: 3rem; }
        #flight-results { margin-top: 60px; }
        .results-container { display: flex; flex-direction: column; gap: 1.5rem; }
        .flight-card {
            background: var(--white); border: 1px solid #e9ecef; border-radius: 8px;
            padding: 1.5rem; transition: all 0.3s ease-in-out;
        }
        .flight-card.expanded {
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-color: var(--primary-blue);
        }
        .flight-main-info {
            display: grid; grid-template-columns: 1fr 1fr auto 1fr;
            align-items: center; gap: 1rem;
        }
        .flight-info .time { font-size: 1.5rem; font-weight: 600; color: var(--primary-blue); }
        .flight-info .airport { font-size: 1.1rem; color: var(--dark-text); }
        .flight-duration { text-align: center; color: var(--gray-text); }
        .flight-duration .arrow { color: var(--accent-yellow); font-weight: 600; }
        .flight-price .price { font-size: 1.8rem; font-weight: 700; color: var(--primary-blue); }
        .flight-price { text-align: right; }
        .select-button { background-color: var(--success-green); color: var(--white); border: none; padding: 0.6rem 1.2rem; border-radius: 5px; cursor: pointer; margin-top: 0.5rem; transition: background-color 0.3s; font-weight: 500;}
        .select-button:hover { background-color: #218838; }

        .flight-options {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, margin-top 0.5s ease-in-out, padding-top 0.5s ease-in-out;
            border-top: 1px solid transparent;
        }
        .flight-card.expanded .flight-options {
            max-height: 500px;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top-color: #e9ecef;
        }
        .option-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.6rem 0;
            font-size: 1rem;
        }
        .option-label { display: flex; align-items: center; gap: 0.8rem; cursor: pointer; }
        .option-price { font-weight: 600; color: var(--secondary-blue); }

        .baggage-selector { display: flex; align-items: center; gap: 0.5rem; }
        .quantity-btn {
            background-color: #e9ecef; border: 1px solid #ced4da; width: 30px; height: 30px;
            font-size: 1.2rem; font-weight: 600; color: var(--secondary-blue);
            border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;
            transition: background-color 0.2s;
        }
        .quantity-btn:hover { background-color: #d8dee4; }
        .baggage-quantity {
            width: 40px; text-align: center; font-size: 1.1rem; font-weight: 500;
            border: 1px solid #ced4da; border-radius: 5px; padding: 0.2rem;
            -moz-appearance: textfield;
        }
        .baggage-quantity::-webkit-outer-spin-button, .baggage-quantity::-webkit-inner-spin-button {
            -webkit-appearance: none; margin: 0;
        }

        .hidden { display: none; }
        @media (max-width: 992px) { .form-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div id="notification-bar" class="notification"></div>

    <header class="container"><nav class="navbar"><a href="index.html" class="nav-logo">𝒞𝑜𝓃 𝒞𝒽𝒾𝓂 𝒜𝒾𝓇𝓁𝒾𝓃𝑒𝓈<span>.</span></a></nav></header>

    <main>
        <section class="section booking-section">
            <div class="container">
                <h2 class="section-title">Book Your Flight</h2>
                <p class="section-subtitle">Find the best low-cost fares connecting Vietnam and the world. Your journey starts here.</p>

                <form id="booking-form" class="booking-form">
                     <div class="trip-type">
                        <label><input type="radio" name="trip-type" value="one-way" checked> One Way</label>
                        <label><input type="radio" name="trip-type" value="round-trip"> Round Trip</label>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="from-airport">From</label>
                            <select id="from-airport" name="from" required>
                                <option value="">Select Departure</option>
                                <option value="SGN">Ho Chi Minh City (SGN)</option>
                                <option value="HAN">Hanoi (HAN)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="to-airport">To</label>
                            <select id="to-airport" name="to" required><option value="">Select Destination</option></select>
                        </div>
                        <div class="form-group">
                            <label for="depart-date">Depart</label>
                            <input type="date" id="depart-date" name="depart-date" required>
                        </div>
                        <div class="form-group" id="return-date-group">
                            <label for="return-date">Return</label>
                            <input type="date" id="return-date" name="return-date">
                        </div>
                    </div>
                    <div class="form-group full-width" style="margin-top: 2rem;"><button type="submit" class="submit-btn">Search Flights</button></div>
                </form>
            </div>
        </section>

        <section id="flight-results" class="section hidden">
            <div class="container" id="results-container"></div>
        </section>
    </main>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- DOM Elements & Data ---
        const bookingForm = document.getElementById('booking-form');
        const fromAirportSelect = document.getElementById('from-airport');
        const toAirportSelect = document.getElementById('to-airport');
        const returnDateGroup = document.getElementById('return-date-group');
        const tripTypeRadios = document.querySelectorAll('input[name="trip-type"]');
        const flightResultsSection = document.getElementById('flight-results');
        const resultsContainer = document.getElementById('results-container');
        const notificationBar = document.getElementById('notification-bar');

        const allDestinations = {
            'LAX': 'Los Angeles (LAX)', 'SFO': 'San Francisco (SFO)', 'IAH': 'Houston (IAH)',
            'JFK': 'New York (JFK)', 'SEA': 'Seattle (SEA)', 'DFW': 'Dallas/Fort Worth (DFW)',
            'ORD': 'Chicago (ORD)', 'BOS': 'Boston (BOS)', 'SAN': 'San Diego (SAN)',
            'IAD': 'Washington D.C. (IAD)', 'YYZ': 'Toronto (YYZ)', 'YVR': 'Vancouver (YVR)',
            'LHR': 'London (LHR)', 'CDG': 'Paris (CDG)'
        };
        const routes = {
            'SGN': ['LAX', 'SFO', 'IAH', 'JFK', 'SEA', 'DFW', 'ORD', 'BOS', 'SAN', 'YYZ', 'YVR', 'LHR', 'CDG'],
            'HAN': ['IAD', 'LHR', 'CDG']
        };

        // --- Form Event Listeners ---
        fromAirportSelect.addEventListener('change', function() {
            const selectedDeparture = this.value;
            toAirportSelect.innerHTML = '<option value="">Select Destination</option>';
            if (selectedDeparture && routes[selectedDeparture]) {
                routes[selectedDeparture].forEach(code => {
                    const option = document.createElement('option');
                    option.value = code;
                    option.textContent = allDestinations[code];
                    toAirportSelect.appendChild(option);
                });
            }
        });

        tripTypeRadios.forEach(radio => {
            radio.addEventListener('change', function() {
                const isRoundTrip = this.value === 'round-trip';
                returnDateGroup.style.display = isRoundTrip ? 'flex' : 'none';
                returnDateGroup.querySelector('input').required = isRoundTrip;
            });
        });

        bookingForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const isRoundTrip = document.querySelector('input[name="trip-type"]:checked').value === 'round-trip';
            flightResultsSection.classList.remove('hidden');
            resultsContainer.innerHTML = '<p style="text-align:center;">Searching for the best deals...</p>';
            flightResultsSection.scrollIntoView({ behavior: 'smooth' });
            setTimeout(() => generateMockResults(fromAirportSelect.value, toAirportSelect.value, isRoundTrip), 1000);
        });

        // --- Main Event Delegation for All Card Interactions ---
        resultsContainer.addEventListener('click', function(event) {
            const target = event.target;
            const card = target.closest('.flight-card');
            if (!card) return;

            // Handle "Select Flight" / "Confirm" button
            if (target.classList.contains('select-button')) {
                const isExpanded = card.classList.contains('expanded');

                // If it's already expanded, this is a confirmation click
                if (isExpanded) {
                    showNotification('Your selection is confirmed. See you on our flight!');
                }

                // Collapse all other cards in the same group and reset them
                const parentGroup = card.closest('.results-group');
                parentGroup.querySelectorAll('.flight-card.expanded').forEach(otherCard => {
                    if (otherCard !== card) {
                        otherCard.classList.remove('expanded');
                        otherCard.querySelector('.select-button').textContent = 'Select Flight';
                        resetCardOptions(otherCard);
                    }
                });

                // Toggle the current card
                card.classList.toggle('expanded');
                target.textContent = card.classList.contains('expanded') ? 'Confirm Selection' : 'Select Flight';

                // If we just collapsed the card, reset its options
                if (!card.classList.contains('expanded')) {
                    resetCardOptions(card);
                }
            }

            // Handle Checkbox clicks or Baggage +/- buttons
            if (target.matches('input[type="checkbox"], .quantity-btn')) {
                updateFlightPrice(card);
            }

            // Handle Baggage +/- button logic specifically
            if (target.classList.contains('quantity-btn')) {
                const quantityInput = card.querySelector('.baggage-quantity');
                let currentValue = parseInt(quantityInput.value);
                if (target.classList.contains('plus-btn') && currentValue < 10) {
                    quantityInput.value = currentValue + 1;
                } else if (target.classList.contains('minus-btn') && currentValue > 0) {
                    quantityInput.value = currentValue - 1;
                }
            }
        });

        // --- Main Functions ---
        function updateFlightPrice(card) {
            const basePrice = parseFloat(card.dataset.basePrice);
            let additionalCosts = 0;
            card.querySelectorAll('.option-item input[type="checkbox"]').forEach(box => {
                if (box.checked) additionalCosts += parseFloat(box.dataset.price);
            });
            const baggageItem = card.querySelector('.baggage-option-item');
            if (baggageItem) {
                const baggageInput = baggageItem.querySelector('.baggage-quantity');
                const pricePerBag = parseFloat(baggageItem.dataset.pricePerBag);
                const numBags = parseInt(baggageInput.value);
                const baggageCost = numBags * pricePerBag;
                additionalCosts += baggageCost;
                baggageItem.querySelector('.baggage-price-display').textContent = `+$${baggageCost}`;
            }
            card.querySelector('.flight-total-price').textContent = `$${basePrice + additionalCosts}`;
        }

        function resetCardOptions(card) {
            card.querySelectorAll('input[type="checkbox"]').forEach(box => box.checked = false);
            const baggageInput = card.querySelector('.baggage-quantity');
            if(baggageInput) baggageInput.value = 0;
            updateFlightPrice(card); // Recalculate price to show the reset state
        }

        function showNotification(message) {
            notificationBar.textContent = message;
            notificationBar.classList.add('show');
            setTimeout(() => {
                notificationBar.classList.remove('show');
            }, 4000);
        }

        function getFlightCardHTML(flight, from, to) {
             return `
                <div class="flight-card" data-base-price="${flight.price}">
                    <div class="flight-main-info">
                        <div class="flight-info"><div class="time">${flight.time}</div><div class="airport">${from}</div></div>
                        <div class="flight-duration"><div>${flight.duration}</div><div class="arrow">→</div><div>Non-stop</div></div>
                        <div class="flight-info" style="text-align: right;"><div class="time">${flight.arrival}</div><div class="airport">${to}</div></div>
                        <div class="flight-price"><div class="price flight-total-price">$${flight.price}</div><button class="select-button">Select Flight</button></div>
                    </div>
                    <div class="flight-options">
                        <div class="option-item">
                            <label class="option-label"><input type="checkbox" data-price="25"><span>Served Food & Drinks</span></label>
                            <span class="option-price">+$25</span>
                        </div>
                        <div class="option-item baggage-option-item" data-price-per-bag="45">
                            <span class="option-label">Checked Bags (23kg)</span>
                            <div class="baggage-selector">
                                <button class="quantity-btn minus-btn">-</button>
                                <input type="number" class="baggage-quantity" value="0" min="0" max="10" readonly>
                                <button class="quantity-btn plus-btn">+</button>
                            </div>
                            <span class="option-price baggage-price-display">+$0</span>
                        </div>
                        <div class="option-item">
                            <label class="option-label"><input type="checkbox" data-price="20"><span>Priority Boarding</span></label>
                            <span class="option-price">+$20</span>
                        </div>
                        <div class="option-item">
                            <label class="option-label"><input type="checkbox" data-price="60"><span>Extra Legroom Seat</span></label>
                            <span class="option-price">+$60</span>
                        </div>
                        <div class="option-item">
                            <label class="option-label"><input type="checkbox" data-price="15"><span>Pre-paid Wi-Fi</span></label>
                            <span class="option-price">+$15</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateMockResults(from, to, isRoundTrip) {
            if (!from || !to) {
                 resultsContainer.innerHTML = '<p style="text-align:center;">Please select departure and destination airports.</p>';
                 return;
            }
            const departingFlights = [
                { time: '08:00', arrival: '12:45 PM', duration: '15h 45m', price: 650 },
                { time: '13:30', arrival: '06:20 PM', duration: '15h 50m', price: 635 },
                { time: '21:15', arrival: '02:05 AM', duration: '15h 50m', price: 710 },
            ];
            const returningFlights = [
                { time: '10:30', arrival: '03:15 PM', duration: '15h 45m', price: 680 },
                { time: '15:00', arrival: '07:50 PM', duration: '15h 50m', price: 660 },
            ];

            let finalHTML = `<div class="results-group"><h3 class="results-title">Departing Flights: ${from} → ${to}</h3>`;
            departingFlights.forEach(flight => finalHTML += getFlightCardHTML(flight, from, to));
            finalHTML += `</div>`;

            if (isRoundTrip) {
                finalHTML += `<div class="results-group"><h3 class="results-title">Returning Flights: ${to} → ${from}</h3>`;
                returningFlights.forEach(flight => finalHTML += getFlightCardHTML(flight, to, from));
                finalHTML += `</div>`;
            }

            resultsContainer.innerHTML = finalHTML;
        }
    });
    </script>
</body>
</html>